CREATE TABLE ASIGNATURAS_MATRICULA (ASIGNATURA_REFERENCIA INTEGER NOT NULL, GRUPO_ID INTEGER, CURSO_ACADEMICO VARCHAR(255) NOT NULL, EXPEDIENTE_NUM_EXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (ASIGNATURA_REFERENCIA, CURSO_ACADEMICO, EXPEDIENTE_NUM_EXPEDIENTE))
CREATE TABLE ASIGNATURA (REFERENCIA INTEGER NOT NULL, DTYPE VARCHAR(31), CODIGO INTEGER NOT NULL, CREDITOS INTEGER NOT NULL, CUATRIMESTRE VARCHAR(255), CURSO VARCHAR(255), DURACION VARCHAR(255), IDIOMAS_DE_IMPARTICION VARCHAR(255), NOMBRE VARCHAR(255) NOT NULL, OFERTADA INTEGER NOT NULL, ASIGNATURAS_TITULACION_CODIGO INTEGER, PRIMARY KEY (REFERENCIA))
CREATE TABLE TITULACION (CODIGO INTEGER NOT NULL, CREDITOS INTEGER NOT NULL, NOMBRE VARCHAR(255) NOT NULL, PRIMARY KEY (CODIGO))
CREATE TABLE EXPEDIENTES (NUM_EXPEDIENTE INTEGER NOT NULL, ACTIVO TINYINT(1) default 0, CREDITOS_CF INTEGER, CREDITOS_FB INTEGER, CREDITOS_OB INTEGER, CREDITOS_OP INTEGER, CREDITOS_PE INTEGER, CREDITOS_TF INTEGER, CREDITOS_SUPERADOS INTEGER, NOTA_MEDIA_PROVISIONAL DOUBLE, ALUMNO_ID INTEGER, TITULACION_CODIGO INTEGER, PRIMARY KEY (NUM_EXPEDIENTE))
CREATE TABLE MATRICULA (CURSO_ACADEMICO VARCHAR(255) NOT NULL, ESTADO VARCHAR(255) NOT NULL, FECHA_DE_MATRICULA DATE NOT NULL, LISTADO_ASIGNATURAS VARCHAR(255), NUEVO_INGRESO TINYINT(1) default 0, NUM_ARCHIVO INTEGER, NUM_EXPEDIENTE INTEGER, TURNO_PREFERENTE VARCHAR(255), EXPEDIENTE_NUM_EXPEDIENTE INTEGER NOT NULL, PRIMARY KEY (CURSO_ACADEMICO, EXPEDIENTE_NUM_EXPEDIENTE))
CREATE TABLE ENCUESTA (FECHA_DE_ENVIO DATE NOT NULL, EXPEDIENTE_NUM_EXPEDIENTE INTEGER, PRIMARY KEY (FECHA_DE_ENVIO))
CREATE TABLE CENTRO (ID INTEGER NOT NULL, DIRECCION VARCHAR(255) NOT NULL, NOMBRE VARCHAR(255) UNIQUE, TLF_CONSERJERIA INTEGER, PRIMARY KEY (ID))
CREATE TABLE CLASE (DIA DATETIME NOT NULL, HORAINICIO DATETIME NOT NULL, HORAFIN DATETIME, ASIGNATURA_REFERENCIA INTEGER, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (DIA, HORAINICIO, GRUPO_ID))
CREATE TABLE GRUPO (ID INTEGER NOT NULL, ASIGNAR VARCHAR(255), CURSO VARCHAR(255) UNIQUE, INGLES TINYINT(1) default 0 NOT NULL, LETRA VARCHAR(255) UNIQUE, PLAZAS INTEGER, TURNO_MANANA_TARDE VARCHAR(255) NOT NULL, VISIBLE TINYINT(1) default 0, ID_GRUPO_ID INTEGER, TITULACION_CODIGO INTEGER, PRIMARY KEY (ID))
CREATE TABLE GRUPO_POR_ASIGNATURA (CURSO_ACADEMICO VARCHAR(255) NOT NULL, OFERTA VARCHAR(255), ASIGNATURA_REFERENCIA INTEGER NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
CREATE TABLE OPTATIVAS (REFERENCIA INTEGER NOT NULL, MENCION VARCHAR(255), PLAZAS INTEGER, PRIMARY KEY (REFERENCIA))
CREATE TABLE ALUMNO (ID INTEGER NOT NULL, ALUMNOMOVILIDAD TINYINT(1) default 0, CODIGOPOSTAL INTEGER, DNI VARCHAR(255) UNIQUE, DIRECCION VARCHAR(255), EMAIL_INSTITUCIONAL VARCHAR(255) NOT NULL, EMAIL_PERSONAL VARCHAR(255), LOCALIDAD VARCHAR(255), MOVIL INTEGER, NOMBRE_COMPLETO VARCHAR(255) NOT NULL, PROVINCIA VARCHAR(255), TELEFONO INTEGER, PRIMARY KEY (ID))
CREATE TABLE Titulacion_Centro (titu_fk INTEGER NOT NULL, cen_fk INTEGER NOT NULL, PRIMARY KEY (titu_fk, cen_fk))
CREATE TABLE GRUPO_POR_ASIGNATURA_ENCUESTA (encuesta_FECHA_DE_ENVIO DATE NOT NULL, CURSO_ACADEMICO VARCHAR(255) NOT NULL, ASIGNATURA_REFERENCIA INTEGER NOT NULL, GRUPO_ID INTEGER NOT NULL, PRIMARY KEY (encuesta_FECHA_DE_ENVIO, CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID))
ALTER TABLE ASIGNATURAS_MATRICULA ADD CONSTRAINT FK_ASIGNATURAS_MATRICULA_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE ASIGNATURAS_MATRICULA ADD CONSTRAINT FK_ASIGNATURAS_MATRICULA_CURSO_ACADEMICO FOREIGN KEY (CURSO_ACADEMICO, EXPEDIENTE_NUM_EXPEDIENTE) REFERENCES MATRICULA (CURSO_ACADEMICO, EXPEDIENTE_NUM_EXPEDIENTE)
ALTER TABLE ASIGNATURAS_MATRICULA ADD CONSTRAINT FK_ASIGNATURAS_MATRICULA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE ASIGNATURA ADD CONSTRAINT FK_ASIGNATURA_ASIGNATURAS_TITULACION_CODIGO FOREIGN KEY (ASIGNATURAS_TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE EXPEDIENTES ADD CONSTRAINT FK_EXPEDIENTES_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE EXPEDIENTES ADD CONSTRAINT FK_EXPEDIENTES_ALUMNO_ID FOREIGN KEY (ALUMNO_ID) REFERENCES ALUMNO (ID)
ALTER TABLE MATRICULA ADD CONSTRAINT FK_MATRICULA_EXPEDIENTE_NUM_EXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUM_EXPEDIENTE) REFERENCES EXPEDIENTES (NUM_EXPEDIENTE)
ALTER TABLE ENCUESTA ADD CONSTRAINT FK_ENCUESTA_EXPEDIENTE_NUM_EXPEDIENTE FOREIGN KEY (EXPEDIENTE_NUM_EXPEDIENTE) REFERENCES EXPEDIENTES (NUM_EXPEDIENTE)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE CLASE ADD CONSTRAINT FK_CLASE_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_ID_GRUPO_ID FOREIGN KEY (ID_GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPO ADD CONSTRAINT FK_GRUPO_TITULACION_CODIGO FOREIGN KEY (TITULACION_CODIGO) REFERENCES TITULACION (CODIGO)
ALTER TABLE GRUPO_POR_ASIGNATURA ADD CONSTRAINT FK_GRUPO_POR_ASIGNATURA_GRUPO_ID FOREIGN KEY (GRUPO_ID) REFERENCES GRUPO (ID)
ALTER TABLE GRUPO_POR_ASIGNATURA ADD CONSTRAINT FK_GRUPO_POR_ASIGNATURA_ASIGNATURA_REFERENCIA FOREIGN KEY (ASIGNATURA_REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE OPTATIVAS ADD CONSTRAINT FK_OPTATIVAS_REFERENCIA FOREIGN KEY (REFERENCIA) REFERENCES ASIGNATURA (REFERENCIA)
ALTER TABLE Titulacion_Centro ADD CONSTRAINT FK_Titulacion_Centro_cen_fk FOREIGN KEY (cen_fk) REFERENCES CENTRO (ID)
ALTER TABLE Titulacion_Centro ADD CONSTRAINT FK_Titulacion_Centro_titu_fk FOREIGN KEY (titu_fk) REFERENCES TITULACION (CODIGO)
ALTER TABLE GRUPO_POR_ASIGNATURA_ENCUESTA ADD CONSTRAINT FK_GRUPO_POR_ASIGNATURA_ENCUESTA_CURSO_ACADEMICO FOREIGN KEY (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID) REFERENCES GRUPO_POR_ASIGNATURA (CURSO_ACADEMICO, ASIGNATURA_REFERENCIA, GRUPO_ID)
ALTER TABLE GRUPO_POR_ASIGNATURA_ENCUESTA ADD CONSTRAINT GRUPOPORASIGNATURA_ENCUESTAencuesta_FECHA_DE_ENVIO FOREIGN KEY (encuesta_FECHA_DE_ENVIO) REFERENCES ENCUESTA (FECHA_DE_ENVIO)
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(50) NOT NULL, SEQ_COUNT DECIMAL(38), PRIMARY KEY (SEQ_NAME))
INSERT INTO SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0)
